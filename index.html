<!DOCTYPE html>
<html>
	<head>
		<script src="jquery-3.7.1.min.js"></script>
		<!--<script src="script.js"></script> -->
		<script>
			$(document).ready(function() {
			
				const check_gdpr = window.localStorage.getItem("gdpr");
				if(check_gdpr)
				{
					$("#gdpr_banner").hide();
				}

				function userProfile() {
					let api_action = "";
					let jwt_hash = "";
					
					this.setJWT = (hash) => {jwt_hash = hash;}
					this.getJWT = () => jwt_hash;

					this.setAction = (action) => {api_action = action;}
					this.getAction = () => api_action;
				}

				let profile = new userProfile();
				
				$("#home_menu_btn").on("click", function() {
					showMe("#home");
				});

				$("#gdpr_ok").on("click", function() {
					$("#gdpr_banner").hide();
					window.localStorage.setItem("gdpr", 1);
				});
				
				$("#login_btn").on("click", function() {
					showMe("#login");
					profile.setAction("login");
				});

				$("#new_account_btn").on("click", function() {
					showMe("#new_account");
					profile.setAction("new_account");
				});
			
				$(".submit_btn").on("click", function() {
					callAPI(profile.getAction());
				});

				function callAPI(action)
				{
					if( action == "login")
					{
						let email_form = $("#login_email").value;
						let password_form = $("#password_email").value;
						
						$.ajax({
							type: "POST",
        					data: {
								'action':action,
								'email':email_form,
								'password':password_form},
        					url: "api.php",
        					success: function(data){
								var JsonData = jQuery.parseJSON(data);
								profile.setJWT() = JsonData.JWT;
								initDashboard();
							},
							error: function(){
								error();
							}
        				});
					}					

					if( action == "getBoards")
					{
						$.ajax({
							type: "POST",
        					data: {
								'token':profile.getJWT(),
								},
        					url: "api.php",
        					success: function(data){
								return data; 
							},
							error: function(){
								return "error";
							}
        				});
					}					


				}

				function error()
				{
					showMe("#error");
				}

				function showMe(id)
				{
					$(".content_div").hide();
					$(id).show();
				}

				function initDashBoard()
				{
					let boards = callAPI("getBoards"); 
					let boardData = jQuery.parseJSON(boards);
					
					showMe("#dash_board");
				}
				
				showMe("#home");
			});
		</script>

		<style>													
			html, body
			{
				margin:0px;
				padding:0px;
				background:#d8d8d8;
			}
			
			p
			{
				font-family:arial;
				color:#f3f3e0;

			}
			
			#main
			{
				margin:auto;
				width:1080px;
			}
			
			#menu_bar
			{
				display:block;
				float:left;
				width:980px;
				background:#373737;
			}
			
			#menu_bar .menu_link
			{
				display:block;
				float:left;
				padding:10px;
				margin:10px;
				font-family:arial;
				color:#f3f3e0;
				text-decoration:none;
				font-size:17px;
			}
			
			#login_btn
			{
				display:block;
				float:left;
				width:100px;
				background:#696963;
				text-align:center;
				padding:20px 0px;
				font-family:arial;
				color:#f3f3e0;
				font-weight:bold;
				font-size:17px;
			}
			#login_btn:hover
			{
			cursor:pointer;
			}
			
			
			#home
			{
				background:#e44746;
				text-align:center;
				
			}
			
			#home p
			{
				font-size:30px;
			}
			
			.btn_c2
			{
				display:block;
				float:left;
				width:720px;
				min-height:180px;
				text-align:left;
				background-color:#608bc1;
				padding:0px;
				
			}
			
			.btn_c2 p, #home .btn_c2 p, .btn_c1 p, #home .btn_c1 p 
			{
				font-size:24px;
				padding:20px 30px;
			}
			
			.btn_c1
			{
				display:block;
				float:left;
				width:360px;
				min-height:180px;
				background-color:#133e87;
				
			}
			
			.divider
			{
				display:block;
				float:left;
				width:100%;
				height:4px;
				background-color:#f3f3e0;
			}
			
			.content_div
			{
				clear:both;
				display:none;
				float:left;
				width:100%;
				padding:20px 0px 0px 0px;
			}
			
			#gdpr_banner
			{
				position:fixed;
				bottom:0px;
				background-color:rgba(0, 0, 0, 0.8);
				width:100%;
				padding:20px;
				text-align:center;
				
			}

			#gdpr_banner p
			{
				color:#f3f3e0;
				size:14px;
			}

			#gdpr_banner #gdpr_ok
			{
				display: inline-block;
				padding:10px 15px;
				margin:0px 10px;
				background:#009900;
				border:1px solid #FFF;
				color:#f3f3e0;
				size:14px;
				font-family:arial;
			}

			#gdpr_banner #gdpr_ok:hover
			{
				cursor:pointer;
			}
		</style>
	</head>
	<body>
	
	<div id="main">
		<div id="menu_bar">
			<a href="#" id="home_menu_btn" class="menu_link">Home</a>
			<a href="" class="menu_link">test 2</a>
			<a href="" class="menu_link">test 3</a>
		</div>
		<div id="login_btn">Login</div>
		
		
		
		
		<div class="content_div" id="home">
			<img src="images/logo.png">
			<p>Booking and resavation system</p>
			<div class="divider"></div>
			<div class="btn_c2"><p>
				CREATE A FREE BOOKING SITE FOR YOUR MEETING 
				ROOM, VACATION HOUSE, MUSIC STUDIO, CARS 
				OR EVEN YOUR BOAT.</p> 
			</div>
			<div class="btn_c1" id="new_account_btn">
				<p> Create a free account</p>
			</div>
		</div>
		
		
		<div  class="content_div" id="calendar"></div>
	
		
		<div  class="content_div" id="login">
			<table>
				<tr><td>E-mail: </td><td><input id="login_email"></td></tr>
				<tr><td>password: </td><td><input type="password" id="login_password"></td></tr>
				<tr><td colspan="2"><input class="submit_btn" type="button" value="login"></td></tr>
			</table>
		</div>

		
		<div  class="content_div" id="new_account">
			<table>
				<tr><td>E-mail: </td><td><input id="account_email"></td></tr>
				<tr><td>password: </td><td><input type="password" id="account_password"></td></tr>
				<tr><td>Username: </td><td><input id="account_username"></td></tr>
				<tr><td colspan="2"><input class="submit_btn" type="button" value="Create"></td></tr>
			</table>
		</div>


		<div  class="content_div" id="dash_board">
			Welcome user
			<div id="new_btn"></div>
			<div id="messages"></div>
			<div>LIST:</div>

			</div>


		<div  class="content_div" id="error">FEJL</div>
		
		
	</div>
		
	<div id="gdpr_banner">
		<p>bla bla bla. bla bla </p><div id="gdpr_ok">Accept</div>
	</div>
	</body>
</html>